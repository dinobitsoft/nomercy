# 2D Action Game - Complete Documentation

**A comprehensive 2D action platformer game built with Flutter & Flame**

**Created by:** Software Engineering Team  
**Last Updated:** January 2026  
**Version:** 2.0 - AI Enhanced Edition

---

## ğŸ“‹ Table of Contents

1. [Project Overview](#project-overview)
2. [Features](#features)
3. [Architecture](#architecture)
4. [Core Systems](#core-systems)
5. [Game Mechanics](#game-mechanics)
6. [AI Systems](#ai-systems)
7. [Procedural Generation](#procedural-generation)
8. [File Structure](#file-structure)
9. [Setup & Installation](#setup--installation)
10. [Usage Guide](#usage-guide)
11. [API Reference](#api-reference)
12. [Customization](#customization)
13. [Performance](#performance)
14. [Future Enhancements](#future-enhancements)

---

## ğŸ® Project Overview

### What is This Game?

A feature-rich 2D action platformer with:
- **4 Playable Characters** with unique abilities
- **Intelligent AI Enemies** with 5 personality types
- **Infinite Procedural Maps** generated by AI
- **Multiple Game Modes** (Survival, Campaign, Boss Fight, Training)
- **Advanced Combat Mechanics** (combos, stamina, dodging, blocking)
- **Wave-based Progression** with difficulty scaling
- **Gamepad Support** (keyboard, mouse, and controller)

### Technology Stack

- **Framework:** Flutter 3.x
- **Game Engine:** Flame 1.x
- **Language:** Dart
- **Platform:** Cross-platform (iOS, Android, Web, Desktop)

### Game Modes

1. **Survival Mode**: Endless waves of enemies with progressive difficulty
2. **Campaign Mode**: Story-driven levels with boss fights
3. **Boss Fight**: Single epic boss battle
4. **Training Mode**: Practice combat mechanics against passive dummy

---

## âœ¨ Features

### Gameplay Features

#### **Characters (4 Classes)**
- **Knight**: Tank, melee combatant, high HP
- **Thief**: Agile, ranged knives, high mobility
- **Wizard**: Glass cannon, powerful fireballs, long range
- **Trader**: Balanced, bow & arrow, versatile

#### **Combat System**
- âœ… Stamina management (attacks, dodges, jumps cost stamina)
- âœ… Combo system (up to 4+ hit combos with damage bonuses)
- âœ… Blocking & parrying (reduces damage by 70%)
- âœ… Dodge rolls with invincibility frames
- âœ… Jump attacks (aerial combat with higher risk)
- âœ… Attack commitment (can't cancel mid-swing)
- âœ… Knockback effects
- âœ… Landing recovery system
- âœ… Hard landing mechanics (fall damage & stun)

#### **Enemy AI (5 Personalities)**
- **Aggressive**: Rushes in, minimal defense, 90% aggression
- **Defensive**: Cautious, blocks often, 90% caution
- **Balanced**: Mix of offense/defense, 60/50 split
- **Tactical**: Smart positioning, combo-focused, predictive
- **Berserker**: All-in attacks, never blocks, 100% aggression

#### **AI Behaviors**
- âœ… Decision-making system (evaluates 6+ actions per frame)
- âœ… Predictive aiming for ranged attacks
- âœ… Smart stamina management
- âœ… Combo building and execution
- âœ… Context-aware blocking (blocks when player attacks nearby)
- âœ… Projectile evasion (dodges incoming attacks)
- âœ… Jump attacks from elevated positions
- âœ… Adaptive behavior (becomes defensive after damage)
- âœ… Player velocity tracking for prediction

#### **Map Generation (6 Styles)**
- **Arena**: Open combat zone, minimal platforms
- **Platformer**: Vertical challenge, 4 layers of platforms
- **Dungeon**: Rooms connected by corridors
- **Towers**: Sky-high vertical structures
- **Chaos**: Completely random placement
- **Balanced**: Mix of horizontal and vertical gameplay

#### **Difficulty Levels (4 Tiers)**
- **Easy**: Wide platforms (200-300px), forgiving
- **Medium**: Standard platforms (150-250px)
- **Hard**: Narrow platforms (120-200px), precise jumps
- **Expert**: Very narrow (100-150px), perfect timing required

### Technical Features

- âœ… Procedural map generation with seed-based reproducibility
- âœ… Connectivity validation (all platforms reachable)
- âœ… Wave management system with automatic spawning
- âœ… Boss fight system with enhanced enemies
- âœ… Difficulty scaling (enemies get 10% stronger per wave)
- âœ… Reward system (gold & health between waves)
- âœ… Chest system (strategic placement, loot rewards)
- âœ… Gamepad/controller support with auto-detection
- âœ… HUD with health, stamina, combo counter, status indicators
- âœ… Map caching for performance
- âœ… JSON export for procedural maps
- âœ… Persistent storage support (future feature)

---

## ğŸ—ï¸ Architecture

### Design Patterns Used

1. **Component Pattern** (Flame ECS)
    - All game entities are components
    - Modular, reusable, composable

2. **Strategy Pattern** (Bot AI)
    - Different AI behaviors encapsulated
    - Swappable tactics at runtime

3. **Factory Pattern** (Character Creation)
    - Centralized character instantiation
    - Easy to add new character types

4. **Singleton Pattern** (GamepadManager, NetworkManager)
    - Single instance for global state
    - Centralized input/network management

5. **State Pattern** (Game Manager)
    - Wave states, game modes
    - Clean state transitions

### System Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           User Interface Layer              â”‚
â”‚  CharacterSelection â†’ ModeSelection â†’       â”‚
â”‚  MapSelection â†’ GameScreen                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            Game Engine Layer                â”‚
â”‚  ActionGame (Flame Game)                    â”‚
â”‚  - Camera System                            â”‚
â”‚  - Input Handling                           â”‚
â”‚  - Update Loop                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           Core Systems Layer                â”‚
â”‚  - GameManager (Wave/Boss/Campaign)         â”‚
â”‚  - MapLoader (JSON/Procedural)              â”‚
â”‚  - GamepadManager (Input)                   â”‚
â”‚  - HUD (UI Rendering)                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          Game Entities Layer                â”‚
â”‚  - GameCharacter (Abstract)                 â”‚
â”‚    â”œâ”€ Knight                                â”‚
â”‚    â”œâ”€ Thief                                 â”‚
â”‚    â”œâ”€ Wizard                                â”‚
â”‚    â””â”€ Trader                                â”‚
â”‚  - Projectile                               â”‚
â”‚  - Platform                                 â”‚
â”‚  - Chest                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            AI Systems Layer                 â”‚
â”‚  - BotTactic (Interface)                    â”‚
â”‚  - SmartBotAI (Decision Engine)             â”‚
â”‚  - Individual Tactics (Aggressive, etc)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       Procedural Generation Layer           â”‚
â”‚  - ProceduralMapGenerator                   â”‚
â”‚  - MapGeneratorConfig                       â”‚
â”‚  - Connectivity Validation                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## âš™ï¸ Core Systems

### 1. Game Manager System

**Purpose**: Manages game flow, waves, spawning, and difficulty

**Components**:
- Wave system (automatic enemy spawning)
- Boss system (special boss encounters)
- Difficulty scaling (progressive challenge)
- Reward distribution (gold & health)

**Usage**:
```dart
// Initialize
gameManager = GameManager(mode: GameMode.survival);
add(gameManager);

// Notify on enemy death
gameManager.onEnemyDefeated();
```

**Wave Progression**:
```
Wave 1: 2 enemies, Easy
Wave 2: 2-3 enemies, Medium
Wave 3: 3 enemies, Medium
Wave 4: 3-4 enemies, Medium+
Wave 5: 4 enemies + Mini-Boss
Wave 10: AI Upgrade (all bots become Tactical)
Wave 15+: 5+ enemies, Expert difficulty
```

### 2. Map Generation System

**Purpose**: Create infinite, playable maps procedurally

**Algorithm**:
1. Generate platforms based on style
2. Validate connectivity (DFS)
3. Add bridge platforms if needed
4. Place player spawn
5. Place chests strategically

**Usage**:
```dart
// Random map
final map = MapLoader.generateRandomMap();

// Wave-based
final map = MapLoader.generateWaveMap(waveNumber);

// Custom
final map = MapLoader.generateProceduralMap(
  MapGeneratorConfig(
    style: MapStyle.platformer,
    difficulty: MapDifficulty.hard,
    seed: 12345,
  ),
);
```

### 3. Bot AI System

**Purpose**: Intelligent enemy behavior

**Decision-Making Process**:
```
Every 0.1-0.2 seconds:
1. Evaluate all possible actions:
   - Attack
   - Defend (Block)
   - Reposition
   - Evade
   - Dodge
   - Jump Attack
2. Assign priority score to each
3. Execute highest priority action
```

**Priority Factors**:
- Distance to target
- Health percentage
- Stamina availability
- Target vulnerability
- Incoming projectiles
- Combo opportunities

**Usage**:
```dart
// Create bot with specific tactic
final bot = Knight(
  position: Vector2(600, 600),
  playerType: PlayerType.bot,
  botTactic: TacticalTactic(),
);
```

### 4. Combat Mechanics System

**Stamina System**:
- Attack: -15 stamina
- Jump: -20 stamina
- Dodge: -20 stamina
- Air Attack: -20 stamina (+ longer cooldown)
- Regeneration: +15 per second (when idle)

**Combo System**:
```
Hit 1: 100% damage
Hit 2: 115-120% damage (+15-20%)
Hit 3: 130-136% damage (+30-36%)
Hit 4: 145-154% damage (+45-54%)
Hit 5+: Continues scaling
```

**Landing Mechanics**:
```
Normal Landing (speed < 400): 0.2s recovery
Hard Landing (speed > 400): 
  - Stun duration = (speed - 400) / 200
  - Fall damage = (speed - 400) / 50
  - Visual stars effect
```

### 5. Input System

**Supported Inputs**:
- Touch (mobile)
- Mouse (desktop)
- Keyboard (WASD, Arrow Keys, Space)
- Gamepad (detected automatically)

**Gamepad Mapping**:
- Left Stick / D-Pad: Movement
- A / X / R1 / Space: Attack
- Dodge: Movement + Crouch
- Block: Down / Special button

---

## ğŸ¯ Game Mechanics

### Character Stats

| Stat | Knight | Thief | Wizard | Trader |
|------|--------|-------|--------|--------|
| **Power** | 15 | 8 | 6 | 10 |
| **Magic** | 5 | 6 | 18 | 7 |
| **Dexterity** | 8 | 16 | 7 | 12 |
| **Intelligence** | 7 | 10 | 14 | 11 |
| **Attack Damage** | 15 | 10 | 20 | 12 |
| **Attack Range** | 2.0 | 8.0 | 10.0 | 12.0 |
| **Weapon** | Sword | Knives | Fireball | Bow |

### Combat Formulas

**Damage Calculation**:
```
Base Damage = Character.attackDamage
Combo Multiplier = 1.0 + (comboCount - 1) Ã— 0.15-0.25
Final Damage = Base Damage Ã— Combo Multiplier
```

**Blocking Reduction**:
```
Blocked Damage = Incoming Damage Ã— 0.3 (70% reduction)
Stamina Cost = 15 per block
Guard Break: Stamina <= 0
```

**Dodge Invincibility**:
```
Duration: 0.3 seconds
Cooldown: 2.0 seconds
Stamina Cost: 20
Movement: Fast dash in chosen direction
```

### Platform Physics

**Jump Parameters**:
- Max Jump Height: 300 pixels
- Max Jump Distance: 400 pixels
- Jump Velocity: -300 (upward)
- Gravity: 1000 pixels/secÂ²
- Terminal Velocity: 800 pixels/sec

**Platform Reachability**:
```dart
if (targetY < currentY) {
  // Platform is higher
  canReach = (verticalDist <= 300) && (horizontalDist <= 400);
} else {
  // Platform is lower (falling)
  canReach = (horizontalDist <= 600); // More lenient
}
```

---

## ğŸ¤– AI Systems

### Bot Decision Tree

```
Frame Update:
â”œâ”€ If stunned/landing â†’ Skip
â”œâ”€ Update player tracking
â”œâ”€ Decision time? (every 0.1-0.2s)
â”‚  â”œâ”€ Evaluate Attack (priority based on range, stamina, opportunity)
â”‚  â”œâ”€ Evaluate Defend (priority based on health, incoming attack)
â”‚  â”œâ”€ Evaluate Reposition (priority based on optimal range)
â”‚  â”œâ”€ Evaluate Evade (priority based on projectile danger)
â”‚  â”œâ”€ Evaluate Dodge (priority based on close threat)
â”‚  â””â”€ Evaluate Jump Attack (priority based on height advantage)
â”œâ”€ Execute highest priority action
â””â”€ Handle immediate threats (emergency dodge)
```

### Personality Parameters

| Personality | Aggression | Caution | Optimal Range | Stamina Reserve | Reaction Time |
|------------|-----------|---------|---------------|-----------------|---------------|
| **Aggressive** | 0.9 | 0.2 | 150px | 20 | 0.15s |
| **Defensive** | 0.3 | 0.9 | 350px | 40 | 0.10s |
| **Balanced** | 0.6 | 0.5 | 250px | 25 | 0.15s |
| **Tactical** | 0.6 | 0.7 | 250px | 30 | 0.12s |
| **Berserker** | 1.0 | 0.0 | 100px | 10 | 0.20s |

### AI Learning & Adaptation

**Memory System**:
```dart
consecutiveHits: int       // Tracks successful hits
consecutiveMisses: int     // Tracks missed attacks
lastPlayerPosition: Vector2 // For velocity estimation
playerVelocityEstimate: double // Predictive aiming
```

**Adaptation**:
- After 3+ consecutive hits: Becomes more defensive
- Heavy damage (>20): Increases retreat priority
- Low health (<30%): Switches to defensive tactics
- Every 10 kills: All bots upgrade to Tactical AI

---

## ğŸ—ºï¸ Procedural Generation

### Generation Algorithms

#### **Arena Generation**
```
1. Create ground platform (90% map width)
2. Add 3-6 elevated platforms
3. Random placement within bounds
4. Ensure minimum spacing
```

#### **Platformer Generation**
```
1. Create ground platform (100% map width)
2. For each layer (1-4):
   a. Calculate Y position (layer Ã— 200px)
   b. Create 3-5 platforms per layer
   c. Distribute evenly with random offset
```

#### **Dungeon Generation**
```
1. Create 4-7 rooms (random size/position)
2. Ensure no overlaps
3. Connect adjacent rooms with corridors
4. Add platforms inside rooms
```

#### **Towers Generation**
```
1. Create ground platform
2. For each tower (3-5 total):
   a. Choose X position
   b. Stack 4-6 platforms vertically
   c. Maintain consistent spacing
```

#### **Chaos Generation**
```
1. Create ground platform
2. Place platforms completely randomly
3. Validate no overlaps
4. Continue until target count reached
```

#### **Balanced Generation**
```
1. Create ground platform
2. Add Layer 1 (4 platforms at Y=250)
3. Add Layer 2 (3 platforms at Y=450)
4. Add Layer 3 (2 platforms at Y=650)
5. Add 3 random platforms for variety
```

### Connectivity Validation

**Algorithm**: Depth-First Search (DFS)

```
1. Build graph of platform connections
2. For each platform pair:
   - Check if reachable via jump
   - Add edge if reachable
3. Run DFS from player spawn platform
4. Mark all visited platforms
5. For each unvisited platform:
   - Find closest visited platform
   - Add bridge platform between them
6. Repeat until all platforms reachable
```

### Seed System

**How It Works**:
```dart
// Same seed = same random sequence = same map
random = Random(seed);

// All decisions use this random instance
final x = random.nextDouble() * width;
final y = random.nextDouble() * height;
```

**Use Cases**:
- **Speedrunning**: Fixed seed for fair competition
- **Daily Challenges**: Date-based seed everyone shares
- **Sharing**: "Check out seed 12345!"
- **Testing**: Reproducible maps for debugging

---

## ğŸ“ File Structure

```
lib/
â”œâ”€â”€ main.dart                              # App entry point
â”œâ”€â”€ character_selection_screen.dart        # Character picker UI
â”œâ”€â”€ mode_selection_screen.dart             # Game mode picker UI
â”œâ”€â”€ map_selection_screen.dart              # Map picker UI (procedural/premade)
â”œâ”€â”€ level_selection_screen.dart            # Legacy level picker
â”œâ”€â”€ game_screen.dart                       # Game container
â”œâ”€â”€ action_game.dart                       # Main game logic (Flame)
â”œâ”€â”€ game_manager.dart                      # Wave/boss/difficulty management
â”œâ”€â”€ gamepad_manager.dart                   # Input handling
â”œâ”€â”€ hud.dart                               # UI overlay (health, stamina, etc)
â”œâ”€â”€ character_stats.dart                   # Base stats class
â”œâ”€â”€ player_type.dart                       # Enum: human/bot
â”œâ”€â”€ projectile.dart                        # Projectile entity
â”œâ”€â”€ tiled_platform.dart                    # Platform entity
â”œâ”€â”€ impact_effect.dart                     # Particle effects
â”œâ”€â”€ reward_text.dart                       # Floating damage/reward text
â”œâ”€â”€ enhanced_platform.dart                 # Platform with textures
â”œâ”€â”€ network_manager.dart                   # Multiplayer (future)
â”‚
â”œâ”€â”€ game/
â”‚   â”œâ”€â”€ game_character.dart                # Abstract character class
â”‚   â”œâ”€â”€ bot_tactic.dart                    # AI interface
â”‚   â”‚
â”‚   â”œâ”€â”€ character/                         # Character implementations
â”‚   â”‚   â”œâ”€â”€ knight.dart
â”‚   â”‚   â”œâ”€â”€ thief.dart
â”‚   â”‚   â”œâ”€â”€ wizard.dart
â”‚   â”‚   â””â”€â”€ trader.dart
â”‚   â”‚
â”‚   â”œâ”€â”€ stat/                              # Stat implementations
â”‚   â”‚   â””â”€â”€ stats.dart
â”‚   â”‚
â”‚   â””â”€â”€ tactic/                            # AI implementations
â”‚       â”œâ”€â”€ bot_ai_system.dart             # Core AI engine
â”‚       â”œâ”€â”€ aggressive_tactic.dart
â”‚       â”œâ”€â”€ defensive_tactic.dart
â”‚       â”œâ”€â”€ balanced_tactic.dart
â”‚       â”œâ”€â”€ tactical_tactic.dart
â”‚       â”œâ”€â”€ berserker_tactic.dart
â”‚       â”œâ”€â”€ sniper_tactic.dart
â”‚       â””â”€â”€ coward_tactic.dart
â”‚
â”œâ”€â”€ procedural/                            # Map generation
â”‚   â””â”€â”€ map_generator_core.dart            # Generation engine
â”‚
â”œâ”€â”€ map/                                   # Map system
â”‚   â”œâ”€â”€ game_map.dart                      # Map data structure
â”‚   â””â”€â”€ map_loader.dart                    # Load JSON/procedural
â”‚
â”œâ”€â”€ chest/                                 # Chest system
â”‚   â”œâ”€â”€ chest.dart                         # Chest entity
â”‚   â”œâ”€â”€ chest_data.dart                    # Chest data
â”‚   â”œâ”€â”€ chest_particle.dart                # Particle effects
â”‚   â””â”€â”€ chest_reward.dart                  # Reward enum
â”‚
â””â”€â”€ enemy/                                 # Enemy-specific
    â””â”€â”€ enemy_state.dart                   # State enum

assets/
â”œâ”€â”€ images/                                # Sprites
â”‚   â”œâ”€â”€ knight.png
â”‚   â”œâ”€â”€ knight_attack.png
â”‚   â”œâ”€â”€ thief.png
â”‚   â”œâ”€â”€ thief_attack.png
â”‚   â”œâ”€â”€ wizard.png
â”‚   â”œâ”€â”€ wizard_attack.png
â”‚   â”œâ”€â”€ trader.png
â”‚   â”œâ”€â”€ trader_attack.png
â”‚   â”œâ”€â”€ ground.png
â”‚   â”œâ”€â”€ brick.png
â”‚   â”œâ”€â”€ brick_tile.png
â”‚   â”œâ”€â”€ dower_chest.png
â”‚   â””â”€â”€ dower_chest_opened.png
â”‚
â””â”€â”€ maps/                                  # Map JSON files
    â”œâ”€â”€ level_1.json
    â”œâ”€â”€ level_2.json
    â””â”€â”€ level_3.json
```

---

## ğŸš€ Setup & Installation

### Prerequisites

```bash
Flutter SDK: >= 3.0.0
Dart SDK: >= 3.0.0
```

### Dependencies

```yaml
# pubspec.yaml
dependencies:
  flutter:
    sdk: flutter
  flame: ^1.10.0
  flame_audio: ^2.1.0
  gamepads: ^0.3.0
  font_awesome_flutter: ^10.0.0
  socket_io_client: ^2.0.0  # For multiplayer (future)

dev_dependencies:
  flutter_test:
    sdk: flutter
  flutter_lints: ^2.0.0
```

### Installation Steps

```bash
# 1. Clone repository
git clone <repository-url>
cd <project-directory>

# 2. Install dependencies
flutter pub get

# 3. Run on desired platform
flutter run                    # Current platform
flutter run -d chrome          # Web
flutter run -d windows         # Windows
flutter run -d macos           # macOS
flutter run -d android         # Android
flutter run -d ios             # iOS
```

### Asset Setup

Ensure all assets are in place:
```
assets/images/          âœ“ All character sprites
assets/maps/            âœ“ JSON map files
```

Update `pubspec.yaml`:
```yaml
flutter:
  assets:
    - assets/images/
    - assets/maps/
```

---

## ğŸ“– Usage Guide

### Basic Gameplay Flow

```dart
// 1. User Journey
CharacterSelectionScreen
  â†“ Select Character
ModeSelectionScreen
  â†“ Select Mode
MapSelectionScreen
  â†“ Select Map Type
GameScreen
  â†“ Play Game
```

### Creating a Character

```dart
// In action_game.dart
player = _createCharacter(
  'knight',                    // Class name
  Vector2(100, 600),          // Spawn position
  PlayerType.human,           // Player type
);
```

### Spawning Enemies

```dart
// Manual spawn
final enemy = Knight(
  position: Vector2(800, 600),
  playerType: PlayerType.bot,
  botTactic: TacticalTactic(),
);
game.add(enemy);
game.enemies.add(enemy);

// Automatic (via GameManager)
gameManager = GameManager(mode: GameMode.survival);
// Spawns automatically based on waves
```

### Generating Maps

```dart
// Method 1: Random
final map = MapLoader.generateRandomMap();

// Method 2: Wave-based
final map = MapLoader.generateWaveMap(waveNumber);

// Method 3: Boss arena
final map = MapLoader.generateBossArena();

// Method 4: Custom
final map = MapLoader.generateProceduralMap(
  MapGeneratorConfig(
    style: MapStyle.platformer,
    difficulty: MapDifficulty.hard,
    width: 2400,
    height: 1200,
    minPlatforms: 12,
    maxPlatforms: 18,
    chestCount: 4,
    seed: 12345,
  ),
);

// Method 5: From JSON
final map = await MapLoader.loadMapFromJson('level_1');
```

### Customizing AI

```dart
// Create custom personality
final customBot = Knight(
  position: Vector2(600, 600),
  playerType: PlayerType.bot,
  botTactic: TacticalTactic(), // Or any other tactic
);

// Change tactic at runtime
enemy.botTactic = AggressiveTactic();

// Create custom tactic
class MyCustomTactic implements BotTactic {
  @override
  String get name => 'Custom';
  
  @override
  void execute(GameCharacter bot, GameCharacter target, double dt) {
    // Your custom AI logic
  }
  
  @override
  bool shouldEvade(GameCharacter bot, List<Projectile> projectiles) {
    return projectiles.isNotEmpty;
  }
  
  @override
  void onDamageTaken(GameCharacter bot, double damage) {
    print('Ouch!');
  }
}
```

---

## ğŸ“š API Reference

### GameManager

```dart
class GameManager {
  GameManager({GameMode mode});
  
  // Methods
  void onEnemyDefeated();
  void forceNextWave();
  String getWaveStatus();
  
  // Properties
  int currentWave;
  bool isWaveActive;
  GameMode mode;
}
```

### MapLoader

```dart
class MapLoader {
  // Load map
  static Future<GameMap> loadMap(String mapName, {
    bool procedural = false,
    MapGeneratorConfig? config,
  });
  
  // Generate maps
  static GameMap generateRandomMap({MapDifficulty difficulty});
  static GameMap generateStyleMap(MapStyle style, {MapDifficulty difficulty});
  static GameMap generateWaveMap(int waveNumber);
  static GameMap generateBossArena();
  static GameMap generateProceduralMap(MapGeneratorConfig config);
  
  // Utilities
  static String exportMapToJson(GameMap map);
  static void clearCache();
}
```

### GameCharacter

```dart
abstract class GameCharacter {
  // Properties
  double health;
  double stamina;
  double maxStamina;
  bool isAirborne;
  bool isStunned;
  bool isLanding;
  bool isDodging;
  bool isBlocking;
  bool isAttacking;
  int comboCount;
  
  // Methods
  void attack();
  void dodge(Vector2 direction);
  void startBlock();
  void stopBlock();
  void takeDamage(double damage);
  bool prepareAttack(); // Helper for child classes
}
```

### ProceduralMapGenerator

```dart
class ProceduralMapGenerator {
  ProceduralMapGenerator(MapGeneratorConfig config);
  
  GameMap generate();
}

class MapGeneratorConfig {
  MapGeneratorConfig({
    MapStyle style = MapStyle.balanced,
    MapDifficulty difficulty = MapDifficulty.medium,
    double width = 2400,
    double height = 1200,
    int minPlatforms = 8,
    int maxPlatforms = 15,
    int chestCount = 3,
    bool ensureConnectivity = true,
    int? seed,
  });
}
```

---

## ğŸ¨ Customization

### Adding New Character

1. **Create Stats Class**:
```dart
// lib/game/stat/stats.dart
class ArcherStats extends CharacterStats {
  ArcherStats() : super(
    name: 'Archer',
    power: 9,
    magic: 7,
    dexterity: 15,
    intelligence: 9,
    weaponName: 'Long Bow',
    attackRange: 15.0,
    attackDamage: 14,
    color: Colors.teal,
  );
}
```

2. **Create Character Class**:
```dart
// lib/game/character/archer.dart
class Archer extends GameCharacter {
  Archer({
    required super.position,
    required super.playerType,
    BotTactic? botTactic,
  }) : super(
    botTactic: botTactic ?? TacticalTactic(),
    stats: ArcherStats(),
  );
  
  @override
  void updateHumanControl(double dt) {
    // Movement logic
  }
  
  @override
  void updateBotControl(double dt) {
    if (botTactic != null) {
      botTactic!.execute(this, game.player, dt);
    }
  }
  
  @override
  void attack() {
    if (!prepareAttack()) return;
    
    // Custom attack logic
    final projectile = Projectile(
      position: position.clone(),
      direction: facingRight ? Vector2(1, 0) : Vector2(-1, 0),
      damage: stats.attackDamage,
      owner: playerType == PlayerType.human ? this as Player : null,
      enemyOwner: playerType == PlayerType.bot ? this as Enemy : null,
      color: Colors.teal,
      type: 'arrow',
    );
    game.add(projectile);
    game.projectiles.add(projectile);
  }
}
```

3. **Add to Factory**:
```dart
// In action_game.dart _createCharacter()
case 'archer':
  return Archer(
    position: position,
    playerType: playerType,
    botTactic: botTactic,
  );
```

### Adding New Map Style

```dart
// In map_generator_core.dart

// 1. Add to enum
enum MapStyle {
  // ... existing styles ...
  spiral, // NEW
}

// 2. Add to switch statement
case MapStyle.spiral:
  _generateSpiral();
  break;

// 3. Implement generation method
void _generateSpiral() {
  print('Generating Spiral layout...');
  
  final centerX = config.width / 2;
  final centerY = config.height / 2;
  
  for (int i = 0; i < 12; i++) {
    final angle = i * 0.5;
    final radius = 100 + i * 80;
    final x = centerX + math.cos(angle) * radius;
    final y = centerY + math.sin(angle) * radius;
    
    platforms.add(GeneratedPlatform(
      position: Vector2(x, y),
      size: Vector2(_getPlatformWidth(), 30),
      type: 'brick',
      layer: i,
    ));
  }
}
```

### Adding New AI Personality

```dart
// In bot_ai_system.dart

// 1. Add to enum
enum BotPersonality {
  // ... existing ...
  ninja, // NEW
}

// 2. Add to _initializePersonality()
case BotPersonality.ninja:
  aggressionLevel = 0.7;
  cautionLevel = 0.8;
  staminaReserve = 15;
  optimalRange = 200;
  retreatThreshold = 25;
  reactionTime = 0.08; // Very fast
  break;

// 3. Create tactic class
class NinjaTactic implements BotTactic {
  final SmartBotAI ai = SmartBotAI(
    name: 'Ninja',
    personality: BotPersonality.ninja,
  );
  
  @override
  String get name => ai.name;
  
  @override
  void execute(GameCharacter bot, GameCharacter target, double dt) {
    ai.executeAI(bot, target, dt);
    // Add ninja-specific behaviors
  }
  
  @override
  bool shouldEvade(GameCharacter bot, List<Projectile> projectiles) {
    return true; // Ninjas always evade
  }
  
  @override
  void onDamageTaken(GameCharacter bot, double damage) {
    ai.onDamageTaken(bot, damage);
    // Ninja disappears in smoke!
  }
}
```

---

## âš¡ Performance

### Benchmarks

**Map Generation**:
- Easy: 10-50ms
- Medium: 30-80ms
- Hard: 50-150ms
- Expert: 100-300ms

**AI Decision Making**:
- Per bot: <1ms per frame
- 10 bots: ~5-10ms per frame

**Frame Rate**:
- Target: 60 FPS
- Typical: 55-60 FPS (with 5-10 enemies)

### Optimization Tips

1. **Limit Enemy Count**:
```dart
// In GameManager
final maxEnemies = isMobile ? 5 : 10;
enemiesInWave = enemiesInWave.clamp(2, maxEnemies);
```

2. **Reduce AI Frequency**:
```dart
// In SmartBotAI
reactionTime = isMobile ? 0.3 : 0.15;
```

3. **Clear Map Cache**:
```dart
// Every 5 waves
if (currentWave % 5 == 0) {
  MapLoader.clearCache();
}
```

4. **Disable Connectivity Check**:
```dart
MapGeneratorConfig(
  ensureConnectivity: false, // Faster generation
  // Use only for simple layouts
)
```

5. **Reduce Platform Count**:
```dart
MapGeneratorConfig(
  maxPlatforms: isMobile ? 12 : 18,
)
```

---

## ğŸš€ Future Enhancements

### Planned Features

#### **Gameplay**
- [ ] More character classes (Ninja, Ranger, Paladin)
- [ ] Power-ups & buffs (speed, damage, invincibility)
- [ ] Boss variants (different abilities)
- [ ] Weapon upgrades
- [ ] Skill tree system
- [ ] Achievement system
- [ ] Leaderboards
- [ ] Daily challenges
- [ ] Endless mode variations

#### **Combat**
- [ ] Special abilities per character
- [ ] Ultimate attacks (charge-based)
- [ ] Counter-attack system
- [ ] Grab/throw mechanics
- [ ] Environmental damage
- [ ] Status effects (poison, burn, freeze)

#### **Maps**
- [ ] Moving platforms
- [ ] Destructible platforms
- [ ] Hazards (spikes, lava, saws)
- [ ] Bouncy platforms
- [ ] One-way platforms
- [ ] Teleporters
- [ ] Secret areas
- [ ] Theme biomes (ice, fire, jungle, space)
- [ ] Weather effects
- [ ] Day/night cycle

#### **AI**
- [ ] Team coordination (2v2, 3v3)
- [ ] Learning from player patterns
- [ ] Dynamic difficulty adjustment
- [ ] More personality types
- [ ] Boss-specific AI

#### **Technical**
- [ ] Multiplayer (online PvP)
- [ ] Local co-op
- [ ] Save/load system
- [ ] Replay system
- [ ] Mod support
- [ ] Level editor
- [ ] Map sharing (upload/download)
- [ ] Analytics dashboard

#### **Polish**
- [ ] Better animations
- [ ] Sound effects
- [ ] Background music
- [ ] Particle effects
- [ ] Screen shake
- [ ] Hit stop (freeze frames)
- [ ] Slow motion effects
- [ ] Victory poses
- [ ] Emotes

---

## ğŸ› Known Issues

### Current Limitations

1. **No persistent save system** - Progress resets on app close
2. **No online multiplayer** - Local only
3. **Limited animations** - Static sprites
4. **No sound** - Silent gameplay
5. **Simple graphics** - Placeholder assets
6. **No tutorial** - Learn by playing
7. **Gamepad support** - Basic, not fully tested

### Bug Reports

Report bugs by creating an issue with:
- Description
- Steps to reproduce
- Expected vs actual behavior
- Screenshots/video if applicable
- Platform (iOS/Android/Web/Desktop)

---

## ğŸ“ Contributing

### Code Style

- Follow Dart conventions
- Use meaningful variable names
- Comment complex logic
- Keep functions small (<50 lines)
- Use constants for magic numbers

### Testing

```bash
# Run tests
flutter test

# Run specific test
flutter test test/game_character_test.dart

# Run with coverage
flutter test --coverage
```

### Pull Requests

1. Fork repository
2. Create feature branch
3. Make changes
4. Write tests
5. Submit PR with description

---

## ğŸ“„ License

MIT License - See LICENSE file for details

---

## ğŸ™ Credits

**Development Team**
- Game Design & Architecture
- AI System Implementation
- Procedural Generation Engine
- Combat Mechanics System
- UI/UX Design

**Technologies**
- Flutter & Flame Engine
- Dart Programming Language
- Font Awesome Icons

**Special Thanks**
- Flame Community
- Flutter Team
- Open Source Contributors

---

## ğŸ“ Support

### Getting Help

1. **Documentation**: Read this file
2. **Examples**: Check `map_generator_examples.dart`
3. **Source Code**: Well-commented
4. **Community**: Flutter/Flame Discord

### Contact

- Email: [your-email]
- Discord: [your-discord]
- GitHub: [your-github]

---

## ğŸ‰ Quick Start Checklist

- [ ] Install Flutter SDK
- [ ] Clone repository
- [ ] Run `flutter pub get`
- [ ] Add assets to folders
- [ ] Run `flutter run`
- [ ] Play the game!
- [ ] Try different characters
- [ ] Test all game modes
- [ ] Generate procedural maps
- [ ] Fight intelligent AI
- [ ] Achieve high wave count
- [ ] Share your best seed!

---

**Built with â¤ï¸ using Flutter & Flame**

*Last Updated: January 2026*
*Version: 2.0 - AI Enhanced Edition*

---

## Appendix: Configuration Examples

### Easy Survival Setup
```dart
GameMode.survival
MapStyle.balanced
MapDifficulty.easy
```

### Hardcore Challenge Setup
```dart
GameMode.survival
MapStyle.chaos
MapDifficulty.expert
All bots: BerserkerTactic()
```

### Training Setup
```dart
GameMode.training
MapStyle.arena
MapDifficulty.easy
Single bot: DefensiveTactic()
```

### Speedrun Category
```dart
GameMode.campaign
MapStyle.platformer
MapDifficulty.medium
Seed: 42069 (fixed)
```

---

**END OF DOCUMENTATION**